<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" type="image/jpeg" href="https://res.cloudinary.com/dij2fdtw4/image/upload/v1769602073/give_a_rosebud_favicon_in_red_please_xqnp4v.jpg">
  <!-- Google tag (gtag.js) - Conversion Tracking -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11161550773"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-11161550773');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4986542893990493"
     crossorigin="anonymous"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Heart & Petal CRM Dashboard for administrators. Manage orders, inventory, and customer data.">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta http-equiv="X-Robots-Tag" content="noindex, nofollow">
  <meta name="author" content="Heart & Petal Admin">
  <title>CRM Dashboard - Heart & Petal (Admin Only)</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@400;700&family=Great+Vibes&display=swap" rel="stylesheet">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Global Error Handler (must load first) -->
  <script src="js/error-handler.js"></script>
  <!-- System Monitor & Error Communication -->
  <script src="js/system-monitor.js"></script>
  <!-- Mobile Menu -->
  <script src="js/mobile-menu.js"></script>
  <!-- Authentication & Navigation -->
  <script src="js/auth.js"></script>
  <script src="js/nav-manager.js"></script>
  <!-- Cute Notifications -->
  <script src="js/notifications.js"></script>
</head>
<body class="bg-ivory font-montserrat min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-white/90 shadow sticky top-0 z-50">
    <div class="container mx-auto flex items-center justify-between py-4 px-6">
      <a href="index.html" class="flex items-center gap-2">
        <img src="https://res.cloudinary.com/dij2fdtw4/image/upload/v1769602073/give_a_rosebud_favicon_in_red_please_xqnp4v.jpg" alt="Heart & Petal Rose Icon" class="h-10 w-10 object-contain">
        <span class="font-playfair text-2xl text-deep-red tracking-wide">Heart & Petal</span>
      </a>
      <!-- Desktop Nav - Hidden on mobile -->
      <nav class="hidden lg:flex space-x-6 text-lg items-center">
        <a href="index.html" class="hover:text-deep-red transition">Home</a>
        <a href="shop.html" class="hover:text-deep-red transition">Shop</a>
        <a href="checkout.html" class="hover:text-deep-red transition">Checkout</a>
        <a href="legal.html" class="hover:text-deep-red transition">Legal</a>
        <a href="admin.html" class="hover:text-deep-red transition font-bold text-deep-red">CRM</a>
        <div class="relative group ml-2">
          <button class="hover:text-champagne-gold transition focus:outline-none">Login | Register</button>
          <div class="absolute right-0 mt-2 w-48 bg-white border border-charcoal rounded shadow-lg opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition z-50">
            <a href="admin.html" class="block px-4 py-2 hover:bg-blush-pink/40">Admin Login</a>
            <a href="customer-login.html" class="block px-4 py-2 hover:bg-blush-pink/40">Customer Login/Register</a>
          </div>
        </div>
      </nav>
      <!-- Mobile Menu Button -->
      <button id="mobile-menu-btn" class="lg:hidden text-deep-red focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
    <!-- Mobile Menu - Hidden on desktop -->
    <div id="mobile-menu" class="hidden lg:hidden bg-white border-t border-charcoal max-h-96 overflow-y-auto">
      <a href="index.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40">Home</a>
      <a href="shop.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40">Shop</a>
      <a href="checkout.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40">Checkout</a>
      <a href="legal.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40">Legal</a>
      <a href="admin.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40 font-bold text-deep-red">CRM</a>
      <a href="customer-login.html" class="block px-4 py-2 text-sm hover:bg-blush-pink/40">Customer Login</a>
    </div>
  </header>

  <main class="container mx-auto px-6 py-12 max-w-4xl">
    <div id="crm-login" class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-8 mt-12">
      <h1 class="text-3xl font-playfair font-bold mb-6 text-center">Admin Login</h1>
      <form id="crm-login-form" class="space-y-6">
        <input type="text" id="crm-username" placeholder="Username" class="w-full border border-charcoal rounded px-4 py-2" required>
        <input type="password" id="crm-password" placeholder="Password" class="w-full border border-charcoal rounded px-4 py-2" required>
        <button type="submit" class="bg-deep-red text-ivory px-8 py-3 rounded-lg font-bold text-lg hover:bg-red-700 transition w-full">Login</button>
        <div id="crm-login-error" class="text-red-600 text-center mt-2 hidden">Invalid credentials.</div>
      </form>
    </div>
    <div id="crm-dashboard" class="hidden">
      <h2 class="text-2xl font-playfair font-bold mb-4">Order & Customer Management</h2>
      <div class="flex flex-col md:flex-row gap-8">
        <!-- Customer Registration -->
        <section class="flex-1 bg-white rounded-lg shadow p-6 mb-8 md:mb-0">
          <h3 class="text-lg font-bold mb-2">Register New Customer</h3>
          <form id="crm-register-form" class="space-y-3">
            <input type="text" id="reg-name" placeholder="Full Name" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="email" id="reg-email" placeholder="Email" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="text" id="reg-address" placeholder="Address" class="w-full border border-charcoal rounded px-3 py-2" required>
            <button type="submit" class="bg-blush-pink text-charcoal px-4 py-2 rounded hover:bg-champagne-gold transition">Register</button>
          </form>
        </section>
        <!-- Order Tracking -->
        <section class="flex-1 bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-bold mb-2">Add Order</h3>
          <form id="crm-order-form" class="space-y-3">
            <input type="text" id="order-id" placeholder="Order ID" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="email" id="order-email" placeholder="Customer Email" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="text" id="order-address" placeholder="Shipping Address" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="text" id="order-type" placeholder="Order Type (e.g. Roses, Combo)" class="w-full border border-charcoal rounded px-3 py-2" required>
            <input type="text" id="order-status" placeholder="Status (e.g. Shipped)" class="w-full border border-charcoal rounded px-3 py-2" required>
            <button type="submit" class="bg-blush-pink text-charcoal px-4 py-2 rounded hover:bg-champagne-gold transition">Add Order</button>
          </form>
        </section>
      </div>
      <!-- Analytics & Insights Dashboard -->
      <div class="mt-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <div class="bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-400 rounded-lg p-6">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-semibold text-green-700">Total Orders</p>
              <p class="text-3xl font-bold text-green-900" id="total-orders">0</p>
            </div>
            <div class="text-4xl">üì¶</div>
          </div>
          <p class="text-xs text-green-700 mt-2">All-time orders</p>
        </div>

        <div class="bg-gradient-to-br from-blue-50 to-cyan-100 border-2 border-blue-400 rounded-lg p-6">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-semibold text-blue-700">Total Customers</p>
              <p class="text-3xl font-bold text-blue-900" id="total-customers">0</p>
            </div>
            <div class="text-4xl">üë•</div>
          </div>
          <p class="text-xs text-blue-700 mt-2">Registered customers</p>
        </div>

        <div class="bg-gradient-to-br from-purple-50 to-pink-100 border-2 border-purple-400 rounded-lg p-6">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-semibold text-purple-700">Total Revenue</p>
              <p class="text-3xl font-bold text-purple-900" id="total-revenue">$0</p>
            </div>
            <div class="text-4xl">üí∞</div>
          </div>
          <p class="text-xs text-purple-700 mt-2">All-time sales</p>
        </div>

        <div class="bg-gradient-to-br from-yellow-50 to-orange-100 border-2 border-yellow-400 rounded-lg p-6">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-semibold text-yellow-700">Avg Order Value</p>
              <p class="text-3xl font-bold text-yellow-900" id="avg-order-value">$0</p>
            </div>
            <div class="text-4xl">üìä</div>
          </div>
          <p class="text-xs text-yellow-700 mt-2">Per transaction</p>
        </div>
      </div>

      <!-- Order Status Analytics -->
      <div class="mt-8 bg-white rounded-lg shadow p-6 mb-8">
        <h3 class="text-lg font-bold mb-4 text-gray-800">üìà Order Status Distribution</h3>
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4" id="status-distribution">
          <p class="text-gray-500">Loading...</p>
        </div>
      </div>

      <!-- Google Analytics Integration -->
      <div class="mt-8 bg-blue-50 border-2 border-blue-300 rounded-lg p-6 mb-8">
        <h3 class="text-lg font-bold mb-3 text-blue-900">üîç Google Analytics Integration</h3>
        <p class="text-sm text-blue-800 mb-4">Track customer behavior, conversion rates, and insights in Google Analytics Dashboard</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="bg-white rounded p-4 border border-blue-200">
            <p class="font-semibold text-gray-800 mb-2">üìä View Analytics Dashboard</p>
            <a href="https://analytics.google.com" target="_blank" class="inline-block bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition text-sm">
              Open Google Analytics
            </a>
          </div>
          <div class="bg-white rounded p-4 border border-blue-200">
            <p class="font-semibold text-gray-800 mb-2">üîë Tracking Code</p>
            <div class="bg-gray-100 rounded p-2 font-mono text-xs text-gray-700 overflow-x-auto">
              AW-11161550773
            </div>
          </div>
          <div class="bg-white rounded p-4 border border-blue-200 md:col-span-2">
            <p class="font-semibold text-gray-800 mb-2">‚úÖ Active Tracking Events</p>
            <ul class="text-sm text-gray-700 space-y-1">
              <li>‚úì Page Views - All pages tracked</li>
              <li>‚úì Purchase Conversions - PayPal integration</li>
              <li>‚úì Order Status Updates - Customer tracking views</li>
              <li>‚úì Cart Actions - Add to cart, remove from cart</li>
              <li>‚úì Customer Events - Login, registration, profile updates</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Website Analytics Dashboard -->
      <div class="mt-8 bg-gradient-to-br from-red-50 to-pink-100 border-2 border-deep-red rounded-lg p-6 mb-8" id="analytics-dashboard">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-deep-red">üìä Live Website Analytics</h3>
          <button onclick="refreshAnalytics()" class="bg-deep-red text-white px-4 py-2 rounded-lg hover:bg-red-700 transition text-sm font-bold">
            üîÑ Refresh
          </button>
        </div>

        <!-- Real-time Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-green-500">
            <p class="text-sm font-semibold text-gray-600">Live Users</p>
            <p class="text-3xl font-bold text-green-600" id="live-users">0</p>
            <p class="text-xs text-gray-500 mt-1">Active now</p>
          </div>
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-blue-500">
            <p class="text-sm font-semibold text-gray-600">Today's Visits</p>
            <p class="text-3xl font-bold text-blue-600" id="today-visits">0</p>
            <p class="text-xs text-gray-500 mt-1">Last 24 hours</p>
          </div>
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-purple-500">
            <p class="text-sm font-semibold text-gray-600">Total Visits</p>
            <p class="text-3xl font-bold text-purple-600" id="total-visits">0</p>
            <p class="text-xs text-gray-500 mt-1">All time</p>
          </div>
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-orange-500">
            <p class="text-sm font-semibold text-gray-600">Unique Visitors</p>
            <p class="text-3xl font-bold text-orange-600" id="unique-visitors">0</p>
            <p class="text-xs text-gray-500 mt-1">Unique IPs</p>
          </div>
        </div>

        <!-- Charts and Tables -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <!-- Top Pages -->
          <div class="bg-white rounded-lg p-4 shadow">
            <h4 class="font-bold text-gray-800 mb-3">üèÜ Top Pages</h4>
            <div id="top-pages" class="space-y-2">
              <p class="text-gray-500 text-sm">Loading...</p>
            </div>
          </div>

          <!-- Top Locations -->
          <div class="bg-white rounded-lg p-4 shadow">
            <h4 class="font-bold text-gray-800 mb-3">üåç Top Locations</h4>
            <div id="top-locations" class="space-y-2">
              <p class="text-gray-500 text-sm">Loading...</p>
            </div>
          </div>
        </div>

        <!-- Visitor Map by Country -->
        <div class="bg-white rounded-lg p-4 shadow mb-6">
          <h4 class="font-bold text-gray-800 mb-3">üó∫Ô∏è Visitors by Country</h4>
          <div id="visitor-countries" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
            <p class="text-gray-500 text-sm">Loading...</p>
          </div>
        </div>

        <!-- Recent Visitors -->
        <div class="bg-white rounded-lg p-4 shadow">
          <h4 class="font-bold text-gray-800 mb-3">üïê Recent Visitors</h4>
          <div class="overflow-x-auto">
            <table class="w-full text-sm">
              <thead class="bg-gray-100">
                <tr>
                  <th class="px-3 py-2 text-left">Time</th>
                  <th class="px-3 py-2 text-left">Page</th>
                  <th class="px-3 py-2 text-left">Location</th>
                  <th class="px-3 py-2 text-left">Country</th>
                </tr>
              </thead>
              <tbody id="recent-visitors">
                <tr><td colspan="4" class="px-3 py-4 text-gray-500 text-center">Loading...</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Analytics Notes -->
        <div class="mt-4 bg-yellow-50 border border-yellow-300 rounded-lg p-4">
          <p class="text-sm text-yellow-800">
            <strong>‚ÑπÔ∏è Note:</strong> Your IP address is automatically excluded from tracking. Live users are counted as unique sessions active within the last 5 minutes.
          </p>
        </div>
      </div>

      <!-- Shopping Cart Analytics -->
      <div class="mt-8 bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-blue-400 rounded-lg p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-blue-900">üõí Shopping Cart Analytics</h3>
        </div>

        <!-- Cart Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-indigo-500">
            <p class="text-sm font-semibold text-gray-600">Active Carts</p>
            <p class="text-3xl font-bold text-indigo-600" id="active-carts">0</p>
            <p class="text-xs text-gray-500 mt-1">Last hour</p>
          </div>
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-green-500">
            <p class="text-sm font-semibold text-gray-600">Cart Value</p>
            <p class="text-2xl font-bold text-green-600" id="cart-value">$0</p>
            <p class="text-xs text-gray-500 mt-1">Total in carts</p>
          </div>
          <div class="bg-white rounded-lg p-4 shadow border-l-4 border-purple-500">
            <p class="text-sm font-semibold text-gray-600">Most Added</p>
            <p class="text-base font-bold text-purple-600" id="top-cart-product">None</p>
            <p class="text-xs text-gray-500 mt-1" id="top-cart-count">0 times</p>
          </div>
        </div>

        <!-- Top Products in Carts -->
        <div class="bg-white rounded-lg p-4 shadow mb-6">
          <h4 class="font-bold text-gray-800 mb-3">üî• Hot Items in Carts</h4>
          <div id="top-cart-products" class="space-y-3">
            <p class="text-gray-500 text-sm">Loading...</p>
          </div>
        </div>

        <!-- Product Views vs Cart Adds -->
        <div class="bg-white rounded-lg p-4 shadow">
          <h4 class="font-bold text-gray-800 mb-3">üëÅÔ∏è Most Viewed Products</h4>
          <div id="product-views" class="space-y-3">
            <p class="text-gray-500 text-sm">Loading...</p>
          </div>
        </div>
      </div>

      <!-- Pricing Recommendations -->
      <div class="mt-8 bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-400 rounded-lg p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-xl font-bold text-green-900">üí° Smart Pricing Suggestions</h3>
          <span class="text-sm text-gray-600">AI-Powered Analysis</span>
        </div>

        <div class="bg-white rounded-lg p-4 shadow">
          <div id="pricing-suggestions" class="space-y-4">
            <p class="text-gray-500 text-sm">Analyzing data...</p>
          </div>
        </div>

        <div class="mt-4 bg-blue-50 border border-blue-300 rounded-lg p-4">
          <p class="text-sm text-blue-800">
            <strong>üìä How it works:</strong> We analyze product views vs. cart additions. Low conversion = consider lowering price. High conversion = demand is strong, consider increasing price.
          </p>
        </div>
      </div>

      <!-- Professional Tips & Optimization Section -->
      <div class="mt-8 bg-gradient-to-br from-indigo-50 to-blue-50 border border-indigo-200 rounded-xl shadow-lg p-6 mb-8">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h3 class="text-2xl font-bold text-gray-900 mb-1">üí° Business Optimization Tips</h3>
            <p class="text-sm text-gray-600">Data-driven recommendations to boost performance</p>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          <!-- Conversion Rate Tip -->
          <div class="bg-white rounded-lg p-5 border border-gray-200 shadow-sm">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                </svg>
              </div>
              <div>
                <h4 class="font-semibold text-gray-900 mb-2">Improve Conversion Rate</h4>
                <p class="text-sm text-gray-600 mb-3">Products with < 5% conversion may need better photos, descriptions, or pricing adjustments.</p>
                <a href="#pricing-suggestions" class="text-deep-red text-sm font-semibold hover:underline">View Pricing Suggestions ‚Üí</a>
              </div>
            </div>
          </div>

          <!-- Peak Traffic Tip -->
          <div class="bg-white rounded-lg p-5 border border-gray-200 shadow-sm">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <div>
                <h4 class="font-semibold text-gray-900 mb-2">Optimize for Peak Hours</h4>
                <p class="text-sm text-gray-600 mb-3">Use the time filter to identify your busiest hours. Schedule promotions and social media posts accordingly.</p>
                <button onclick="document.getElementById('time-filter').value='hour'; updateTimeFilter('hour');" class="text-deep-red text-sm font-semibold hover:underline">Analyze Traffic ‚Üí</button>
              </div>
            </div>
          </div>

          <!-- Cart Abandonment Tip -->
          <div class="bg-white rounded-lg p-5 border border-gray-200 shadow-sm">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
              </div>
              <div>
                <h4 class="font-semibold text-gray-900 mb-2">Reduce Cart Abandonment</h4>
                <p class="text-sm text-gray-600 mb-3">Cart reminders are enabled! Visitors get notifications after 5 minutes of inactivity with items in cart.</p>
                <span class="inline-flex items-center gap-2 text-green-600 text-sm font-semibold">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Active
                </span>
              </div>
            </div>
          </div>

          <!-- Product Interest Tip -->
          <div class="bg-white rounded-lg p-5 border border-gray-200 shadow-sm">
            <div class="flex items-start gap-3">
              <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                </svg>
              </div>
              <div>
                <h4 class="font-semibold text-gray-900 mb-2">Product Interest Tracking</h4>
                <p class="text-sm text-gray-600 mb-3">Visitors who spend 30+ seconds viewing a product get reminded if they leave without purchasing.</p>
                <span class="inline-flex items-center gap-2 text-green-600 text-sm font-semibold">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Active
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-gradient-to-r from-deep-red to-red-700 rounded-lg p-5 text-white">
          <div class="flex items-center justify-between">
            <div>
              <h4 class="font-bold text-lg mb-1">üöÄ Pro Tip: Email Marketing</h4>
              <p class="text-sm text-white/90">Export customer emails from the table below and use them for promotional campaigns. Always include an unsubscribe option.</p>
            </div>
            <button onclick="exportCustomerEmails()" class="bg-white text-deep-red px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition whitespace-nowrap">
              Export Emails
            </button>
          </div>
        </div>
      </div>

      <!-- Data Tables -->
      <div class="mt-10">
        <h3 class="text-lg font-bold mb-2">Registered Customers</h3>
        <table class="w-full text-left border-collapse mb-8">
          <thead>
            <tr class="bg-blush-pink/30">
              <th class="p-2">Name</th>
              <th class="p-2">Email</th>
              <th class="p-2">Address</th>
            </tr>
          </thead>
          <tbody id="crm-customers"></tbody>
        </table>
        <h3 class="text-lg font-bold mb-2">Orders</h3>
        <table class="w-full text-left border-collapse">
          <thead>
            <tr class="bg-blush-pink/30">
              <th class="p-2">Order ID</th>
              <th class="p-2">Customer Email</th>
              <th class="p-2">Shipping Address</th>
              <th class="p-2">Order Type</th>
              <th class="p-2">Status</th>
              <th class="p-2">Update</th>
            </tr>
          </thead>
          <tbody id="crm-orders"></tbody>
        </table>

        <!-- Reviews Management -->
        <h3 class="text-lg font-bold mb-4 mt-12">Customer Reviews Pending Approval</h3>
        <div id="reviews-list" class="space-y-4">
          <p class="text-charcoal/60">No pending reviews</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
    <footer class="bg-white text-black py-6 w-full mt-auto shadow-lg border-t border-gray-200">
      <div class="container mx-auto px-6">
        <div class="flex flex-wrap items-center justify-center gap-4 text-sm">
          <span class="font-playfair text-lg font-bold">Heart & Petal</span>
          <span class="text-gray-400">|</span>
          <a href="mailto:contact@heartandpetal.com" class="hover:text-deep-red transition">contact@heartandpetal.com</a>
          <span class="text-gray-400">|</span>
          <a href="mailto:legal@heartandpetal.com" class="hover:text-deep-red transition">Legal Inquiries</a>
          <span class="text-gray-400">|</span>
          <a href="legal.html" class="hover:text-deep-red transition">Privacy & Terms</a>
          <span class="text-gray-400">|</span>
          <a href="about.html" class="hover:text-deep-red transition">About</a>
          <span class="text-gray-400">|</span>
          <a href="faq.html" class="hover:text-deep-red transition">FAQ</a>
          <span class="text-gray-400">|</span>
          <span class="text-xs">&copy; 2026 Heart & Petal</span>
        </div>
      </div>
    </footer>
  <script src="js/crm.js"></script>
  <script>
    // Review Management System
    function getPendingReviews() {
      const stored = localStorage.getItem('pendingReviews');
      return stored ? JSON.parse(stored) : [];
    }
    
    function getApprovedReviews() {
      const stored = localStorage.getItem('approvedReviews');
      return stored ? JSON.parse(stored) : [];
    }
    
    function savePendingReviews(reviews) {
      localStorage.setItem('pendingReviews', JSON.stringify(reviews));
    }
    
    function saveApprovedReviews(reviews) {
      localStorage.setItem('approvedReviews', JSON.stringify(reviews));
    }
    
    function loadReviewsList() {
      const pending = getPendingReviews();
      const reviewsList = document.getElementById('reviews-list');
      reviewsList.innerHTML = '';
      
      if (pending.length === 0) {
        reviewsList.innerHTML = '<p class="text-charcoal/60">No pending reviews</p>';
        return;
      }
      
      pending.forEach((review, index) => {
        const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);
        const dateStr = new Date(review.submitted).toLocaleDateString();
        
        const reviewCard = document.createElement('div');
        reviewCard.className = 'bg-yellow-50 border-2 border-yellow-300 p-6 rounded-lg';
        reviewCard.innerHTML = `
          <div class="flex justify-between items-start mb-4">
            <div>
              <p class="font-bold text-lg">${review.name}</p>
              <p class="text-sm text-charcoal/60">${review.email}</p>
              <p class="text-sm text-charcoal/60 mt-1">Product ID: ${review.productId}</p>
              <p class="text-sm text-charcoal/60">Submitted: ${dateStr}</p>
            </div>
            <div class="text-champagne-gold font-bold">${stars}</div>
          </div>
          <p class="text-charcoal/80 mb-4 italic">"${review.text}"</p>
          <div class="flex gap-2">
            <button onclick="approveReview(${index})" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">‚úì Approve</button>
            <button onclick="rejectReview(${index})" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition">‚úó Reject</button>
          </div>
        `;
        reviewsList.appendChild(reviewCard);
      });
    }
    
    function approveReview(index) {
      const pending = getPendingReviews();
      const approved = getApprovedReviews();
      
      const review = pending[index];
      review.approved = true;
      approved.push(review);
      
      pending.splice(index, 1);
      savePendingReviews(pending);
      saveApprovedReviews(approved);
      
      showSuccess(`Review from ${review.name} approved!`);
      loadReviewsList();
    }
    
    function rejectReview(index) {
      const pending = getPendingReviews();
      const review = pending[index];
      
      pending.splice(index, 1);
      savePendingReviews(pending);
      
      showInfo(`Review from ${review.name} rejected.`);
      loadReviewsList();
    }
    
    // Load reviews list when dashboard is visible
    const observer = setInterval(() => {
      const dashboard = document.getElementById('crm-dashboard');
      if (dashboard && !dashboard.classList.contains('hidden')) {
        loadReviewsList();
        clearInterval(observer);
      }
    }, 100);
  </script>
  
  <!-- Analytics System -->
  <script src="js/analytics.js"></script>
  <script>
    // Analytics Dashboard Functions
    let currentTimeFilter = 'today';

    function updateTimeFilter(filter) {
      currentTimeFilter = filter;
      const labels = {
        'live': 'Live (5 min)',
        'hour': 'Last Hour',
        'today': 'Last 24 Hours',
        'week': 'Last 7 Days',
        'all': 'All Time'
      };
      document.getElementById('time-label').textContent = labels[filter];
      refreshAnalytics();
    }

    function refreshAnalytics() {
      if (!window.heartAndPetalAnalytics) {
        console.error('Analytics system not loaded');
        return;
      }

      const stats = window.heartAndPetalAnalytics.getStats();
      
      // Filter data based on time selection
      let filteredVisits = stats.todayVisits;
      const now = Date.now();
      
      if (currentTimeFilter === 'live') {
        const fiveMinAgo = now - (5 * 60 * 1000);
        filteredVisits = window.heartAndPetalAnalytics.data.visits.filter(v => v.timestamp > fiveMinAgo).length;
      } else if (currentTimeFilter === 'hour') {
        const oneHourAgo = now - (60 * 60 * 1000);
        filteredVisits = window.heartAndPetalAnalytics.data.visits.filter(v => v.timestamp > oneHourAgo).length;
      } else if (currentTimeFilter === 'week') {
        filteredVisits = stats.weekVisits;
      } else if (currentTimeFilter === 'all') {
        filteredVisits = stats.totalVisits;
      }
      
      // Update main stats
      document.getElementById('live-users').textContent = stats.liveUsers;
      document.getElementById('today-visits').textContent = filteredVisits;
      document.getElementById('total-visits').textContent = stats.totalVisits;
      document.getElementById('unique-visitors').textContent = stats.uniqueVisitors;

      // Update top pages
      const topPagesDiv = document.getElementById('top-pages');
      if (stats.topPages && stats.topPages.length > 0) {
        topPagesDiv.innerHTML = stats.topPages.map(([page, count]) => `
          <div class="flex items-center justify-between py-2 border-b border-gray-200">
            <span class="text-sm text-gray-700">${page}</span>
            <span class="font-bold text-deep-red">${count}</span>
          </div>
        `).join('');
      } else {
        topPagesDiv.innerHTML = '<p class="text-gray-500 text-sm">No data yet</p>';
      }

      // Update top locations
      const topLocationsDiv = document.getElementById('top-locations');
      if (stats.topLocations && stats.topLocations.length > 0) {
        topLocationsDiv.innerHTML = stats.topLocations.map(([location, count]) => `
          <div class="flex items-center justify-between py-2 border-b border-gray-200">
            <span class="text-sm text-gray-700">${location}</span>
            <span class="font-bold text-blue-600">${count}</span>
          </div>
        `).join('');
      } else {
        topLocationsDiv.innerHTML = '<p class="text-gray-500 text-sm">No data yet</p>';
      }

      // Update visitors by country
      const countriesDiv = document.getElementById('visitor-countries');
      const countries = window.heartAndPetalAnalytics.getVisitorsByCountry();
      if (countries && countries.length > 0) {
        countriesDiv.innerHTML = countries.slice(0, 9).map(country => `
          <div class="bg-gray-50 rounded p-3 border border-gray-200">
            <div class="flex items-center justify-between mb-1">
              <span class="text-lg">${getCountryFlag(country.code)}</span>
              <span class="font-bold text-purple-600">${country.count}</span>
            </div>
            <p class="text-sm font-semibold text-gray-800">${country.country}</p>
            <p class="text-xs text-gray-600">${country.cities.length} cities</p>
          </div>
        `).join('');
      } else {
        countriesDiv.innerHTML = '<p class="text-gray-500 text-sm">No data yet</p>';
      }

      // Update recent visitors table
      const recentVisitorsBody = document.getElementById('recent-visitors');
      if (stats.recentVisits && stats.recentVisits.length > 0) {
        recentVisitorsBody.innerHTML = stats.recentVisits.map(visit => `
          <tr class="border-b border-gray-100 hover:bg-gray-50">
            <td class="px-3 py-2 text-gray-700">${formatTime(visit.timestamp)}</td>
            <td class="px-3 py-2 text-gray-800">${visit.page}</td>
            <td class="px-3 py-2 text-gray-700">${visit.city}, ${visit.region}</td>
            <td class="px-3 py-2">${getCountryFlag(visit.countryCode)} ${visit.country}</td>
          </tr>
        `).join('');
      } else {
        recentVisitorsBody.innerHTML = '<tr><td colspan="4" class="px-3 py-4 text-gray-500 text-center">No visitors yet</td></tr>';
      }

      // Update cart analytics
      const cartInsights = window.heartAndPetalAnalytics.getCartInsights();
      document.getElementById('active-carts').textContent = cartInsights.activeCartsCount;
      document.getElementById('cart-value').textContent = '$' + cartInsights.totalCartValue.toFixed(2);
      
      if (cartInsights.topCartProducts && cartInsights.topCartProducts.length > 0) {
        const topProduct = cartInsights.topCartProducts[0];
        document.getElementById('top-cart-product').textContent = topProduct.name.substring(0, 30) + (topProduct.name.length > 30 ? '...' : '');
        document.getElementById('top-cart-count').textContent = `${topProduct.timesAdded} times added`;

        // Update top cart products list
        const topCartProductsDiv = document.getElementById('top-cart-products');
        topCartProductsDiv.innerHTML = cartInsights.topCartProducts.map(product => `
          <div class="flex items-center justify-between py-3 border-b border-gray-200">
            <div class="flex-1">
              <p class="text-sm font-semibold text-gray-800">${product.name}</p>
              <p class="text-xs text-gray-600">$${product.price.toFixed(2)} √ó ${product.totalQuantity} = $${product.totalValue.toFixed(2)}</p>
            </div>
            <div class="text-right">
              <p class="text-lg font-bold text-indigo-600">${product.timesAdded}</p>
              <p class="text-xs text-gray-500">adds</p>
            </div>
          </div>
        `).join('');
      } else {
        document.getElementById('top-cart-product').textContent = 'None';
        document.getElementById('top-cart-count').textContent = '0 times';
        document.getElementById('top-cart-products').innerHTML = '<p class="text-gray-500 text-sm">No cart activity yet</p>';
      }

      // Update product views
      const productInsights = window.heartAndPetalAnalytics.getProductInsights();
      const productViewsDiv = document.getElementById('product-views');
      if (productInsights.topProducts && productInsights.topProducts.length > 0) {
        productViewsDiv.innerHTML = productInsights.topProducts.map(product => {
          const cartProduct = cartInsights.topCartProducts.find(p => p.id === product.id);
          const cartAdds = cartProduct ? cartProduct.timesAdded : 0;
          const conversionRate = product.views > 0 ? ((cartAdds / product.views) * 100).toFixed(1) : 0;
          
          return `
            <div class="flex items-center justify-between py-3 border-b border-gray-200">
              <div class="flex-1">
                <p class="text-sm font-semibold text-gray-800">${product.name}</p>
                <p class="text-xs text-gray-600">$${product.price.toFixed(2)} ‚Ä¢ Conversion: ${conversionRate}%</p>
              </div>
              <div class="flex gap-6 text-center">
                <div>
                  <p class="text-lg font-bold text-blue-600">${product.views}</p>
                  <p class="text-xs text-gray-500">views</p>
                </div>
                <div>
                  <p class="text-lg font-bold text-green-600">${cartAdds}</p>
                  <p class="text-xs text-gray-500">adds</p>
                </div>
              </div>
            </div>
          `;
        }).join('');
      } else {
        productViewsDiv.innerHTML = '<p class="text-gray-500 text-sm">No product views yet</p>';
      }

      // Update pricing suggestions
      const suggestions = window.heartAndPetalAnalytics.getPricingSuggestions();
      const suggestionsDiv = document.getElementById('pricing-suggestions');
      if (suggestions && suggestions.length > 0) {
        suggestionsDiv.innerHTML = suggestions.map(s => {
          const isIncrease = s.suggestion === 'increase';
          const iconColor = isIncrease ? 'text-green-600' : 'text-orange-600';
          const bgColor = isIncrease ? 'bg-green-50 border-green-200' : 'bg-orange-50 border-orange-200';
          const arrow = isIncrease ? '‚Üë' : '‚Üì';
          
          return `
            <div class="${bgColor} border rounded-lg p-4">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-2">
                    <span class="text-2xl ${iconColor}">${arrow}</span>
                    <h5 class="font-bold text-gray-800">${s.productName}</h5>
                  </div>
                  <p class="text-sm text-gray-700 mb-2">${s.reason}</p>
                  <div class="flex items-center gap-4 text-sm">
                    <span class="text-gray-600">Current: <strong>$${s.currentPrice.toFixed(2)}</strong></span>
                    <span class="${iconColor} font-bold">${arrow} Suggested: $${s.recommendedChange.toFixed(2)}</span>
                  </div>
                  <div class="flex gap-4 mt-2 text-xs text-gray-600">
                    <span>üëÅÔ∏è ${s.views} views</span>
                    <span>üõí ${s.cartAdds} cart adds</span>
                  </div>
                </div>
              </div>
            </div>
          `;
        }).join('');
      } else {
        suggestionsDiv.innerHTML = '<p class="text-gray-500 text-sm">Not enough data yet for pricing suggestions. Need at least 10 views per product.</p>';
      }
    }

    function getCountryFlag(countryCode) {
      if (!countryCode || countryCode === 'XX') return 'üè≥Ô∏è';
      const codePoints = countryCode
        .toUpperCase()
        .split('')
        .map(char => 127397 + char.charCodeAt());
      return String.fromCodePoint(...codePoints);
    }

    function formatTime(timestamp) {
      const date = new Date(timestamp);
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      
      if (diffMins < 1) return 'Just now';
      if (diffMins < 60) return `${diffMins}m ago`;
      if (diffMins < 1440) return `${Math.floor(diffMins / 60)}h ago`;
      return date.toLocaleDateString();
    }

    // Export customer emails for marketing
    function exportCustomerEmails() {
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      if (customers.length === 0) {
        alert('No customer emails to export yet.');
        return;
      }

      const emails = customers.map(c => c.email).filter(e => e).join('\n');
      const blob = new Blob([emails], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `customer-emails-${new Date().toISOString().split('T')[0]}.txt`;
      a.click();
      URL.revokeObjectURL(url);

      alert(`‚úÖ Exported ${customers.length} customer email(s)!`);
    }

    // Auto-refresh analytics every 30 seconds
    setInterval(refreshAnalytics, 30000);

    // Initial load
    setTimeout(() => {
      const dashboard = document.getElementById('crm-dashboard');
      if (dashboard && !dashboard.classList.contains('hidden')) {
        refreshAnalytics();
      }
    }, 1000);
  </script>
</body>
</html>
